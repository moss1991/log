# 数据中台建设方案

### 入存管出四项能力

* 数据采集与清洗
* 数据存储与管理
* 数据处理与分析
* 资源管理与调度

# 一、数据采集与清洗 = ETL

```
（原始数据） 
    经过（采集 - 转换 - 装载）
    形成（规范格式数据）
    存储在（规范的地方）   
```
## 1.1 数据获取技术

* 传感器 
* 网络爬虫 
* 网站公开API 
* 日志收集工具 
* 底层数据采集引擎 
* 中间件系统 
* 关系数据库
* ...

## 1.2 网络爬虫数据采集 - scrapy

* 了解法律风险
* 分析目标网站
* 制定爬取策略
* 定时任务爬取数据
* 数据存储系统可定制、可扩展

## 1.3 日志数据采集 - Flume

* 由Cloudera公司开源
* 分布式、可靠和高可用的海量日志采集、聚合和传输的日 志收集系统
* 数据源可定制、可扩展
* 支持多级级联和多路复制
* Flume在传输数据过程中，可以简单的对数据过滤、清洗，去掉不关心的数据，如果需要对复 杂的数据过滤，需要用户自己开发过滤插件，Flume支持第三方过滤插件调用
* 重点内容：过滤插件Interceptor

## 1.4 数据分发中间件 - Kafka

* Kafka 是一个高吞吐、分布式、基于发布/订阅的消息系统，利用Kafka技术可在廉价PC Server 上搭建起大规模消息系统。
* 生产者产生数据，消费者使用数据
* 数据通过（主题：topic）-（分区：partition）-（消息：message）进行隔离
* 角色通过：（生产者：producer）-（缓存代理：broker）-（消费者：consumer、group）进行隔离

## 1.5 传统数据库采集到HDFS

* Sqoop：SQL-to-Hadoop
* 连接传统关系型数据库和Hadoop的桥梁
* 底层用MapReduce程序实现ETL

<br><br><br><br>

# 二、数据存储与管理

## 2.1 分布式文件系统 - HDFS

```
HDFS = Hadoop Distributed File System
```

### HDFS特性：
* 大文件存储：TB-PB
* 容错能力
* 异构和可扩展性：部署在不同设备上，支持水平扩展
* 流式数据访问：
    * 适合批量处理，而不是用户交互式访问；
    * 重点是在数据吞吐量，而不是数据访问的反应时间；
* 一次写入多次读取

### HDFS不适用的场景：
* 低时间延迟数据访问，几十毫秒
* 大量小文件的存储
* 多用户写入，任意修改文件

## HBase

* 开源Apache项目，分布式的非关系数据库系统，基于HDFS的列式数据存储
* 区别见【词汇解释】


## 2.2 数据仓库软件 - Hive

* Hive是基于Hadoop的数据仓库软件
* 把SQL转换成MapReduce执行
* 提供类SQL的查询语言HiveQL（HQL）

### 使用场景：
* 数据仓库：数据抽取、数据转换、数据加载
* 数据汇总
* 非实时分析：日志分析、文本分析
* 数据挖掘：用户行为分析

## 2.3 非关系型数据库 - Nosql

```
定义：一开始是非关系型数据库取代关系型数据库，现在是not only sql，两者各有优点
```

### 优点：
* 灵活的数据模型，能处理非结构化/半结构化的大数据
* 很好的容灾能力，数据能够被划分和备份
* 优良的可扩展性，容易通过添加新节点来简单的扩展
* 低廉的成本,大多数是开源且容易实现
* 读写性能高

### 缺点：
* 不支持许多关系数据库的特性
* 不支持SQL这样的标准查询语
* 基本没有事务

### 存储的数据类型和代表数据库：


| 数据类型 | 数据库 |
|---|---|
| 键值数据 | redis |
| 列族数据 | clickhouse、hbase、cassandra、accmulo、hypertable |
| 文档数据 | mongodb、couchbase、marklogic |
| 图形数据 | neo4j、infinegraph |

## 数据存储规则
* DAMA 指导方案
* 企业自身最佳实践的梳理
* 数据存储与管理制度的建立

<br><br><br><br>

# 三、数据处理与分析

## 数据处理技术 - 批处理

```
处理离线数据，冷数据,单个处理数据量大，处理速度比流慢
```

* 热门技术 - MapReduce 
* 热门技术 - Spark

## 数据处理技术 - 流处理

```
在线，实时产生的数据。单次处理的数据量小，但处理速度更快
```

* 热门技术 - Storm
* 热门技术 - Spark Streaming

<br><br><br><br>

# 四、数据管理

## 4.1 zookeeper

### 应用场景

* 配置文件管理
* 集群管理
* 分布式协调/通知
* 管理集群与Master选举
* 分布式锁（集群唯一）
* 分布式队列（多个客户访问同一组件）

